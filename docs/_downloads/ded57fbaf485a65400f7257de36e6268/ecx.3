.\" Man page generated from reStructuredText.
.
.
.nr rst2man-indent-level 0
.
.de1 rstReportMargin
\\$1 \\n[an-margin]
level \\n[rst2man-indent-level]
level margin: \\n[rst2man-indent\\n[rst2man-indent-level]]
-
\\n[rst2man-indent0]
\\n[rst2man-indent1]
\\n[rst2man-indent2]
..
.de1 INDENT
.\" .rstReportMargin pre:
. RS \\$1
. nr rst2man-indent\\n[rst2man-indent-level] \\n[an-margin]
. nr rst2man-indent-level +1
.\" .rstReportMargin post:
..
.de UNINDENT
. RE
.\" indent \\n[an-margin]
.\" old: \\n[rst2man-indent\\n[rst2man-indent-level]]
.nr rst2man-indent-level -1
.\" new: \\n[rst2man-indent\\n[rst2man-indent-level]]
.in \\n[rst2man-indent\\n[rst2man-indent-level]]u
..
.TH "ECX" "3" "Jan 07, 2026" "" "ecx"
.SH NAME
ecx \- Electrochemistry for Fortran
[image: Alternative text]
[image]
.sp
Electrochemistry for Fortran.
.SH GETTING STARTED
.SS Introduction
.sp
\fIecx\fP a Fortran library for providing a collection of routines for electrochemistry.
A C API allows usage from C, or can be used as a basis for other wrappers.
A Python wrapper allows easy usage from Python.
.sp
To use \fIecx\fP within your \X'tty: link https://github.com/fortran-lang/fpm'\fI\%fpm\fP\X'tty: link'
project, add the following lines to your file:
.INDENT 0.0
.INDENT 3.5
.sp
.EX
[dependencies]
ecx = { git=\(dqhttps://github.com/MilanSkocic/ecx.git\(dq }
.EE
.UNINDENT
.UNINDENT
.SS Dependencies
.INDENT 0.0
.INDENT 3.5
.sp
.EX
gcc>=10
gfortran>=10
fpm>=0.7
stdlib>=0.7
.EE
.UNINDENT
.UNINDENT
.SS Installation
.sp
A Makefile is provided, which uses
\X'tty: link https://fpm.fortran-lang.org'\fI\%fpm\fP\X'tty: link', for building the library.
.INDENT 0.0
.IP \(bu 2
On windows, \X'tty: link https://www.msys2.org'\fI\%msys2\fP\X'tty: link' needs to be installed.
Add the msys2 binary (usually C:\emsys64\eusr\ebin) to the path in
order to be able to use make.
.IP \(bu 2
On Darwin, the \X'tty: link https://formulae.brew.sh/formula/gcc'\fI\%gcc\fP\X'tty: link'
toolchain needs to be installed.
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.sp
.EX
chmod +x configure.sh
\&./configure.sh
make
make test
make install
make uninstall
.EE
.UNINDENT
.UNINDENT
.sp
You need a compiler that can compile the
\X'tty: link https://github.com/fortran-lang/stdlib'\fI\%stdlib\fP\X'tty: link'\&.
.SS License
.sp
MIT
.SH EXAMPLES
.SS Fortran
.INDENT 0.0
.INDENT 3.5
.sp
.EX
program example_in_f
    use iso_fortran_env
    use ecx
    implicit none

    real(real64) :: w(3) = [1.0d0, 1.0d0, 100.0d0]
    real(real64) :: r = 100.0d0
    real(real64) :: p(3) = 0.0d0
    character(len=1) :: e 
    integer :: errstat
    complex(real64) :: zout(3)
    character(len=:), pointer :: errmsg

    p(1) = r
    e = \(dqR\(dq
    call z(p, w, zout, e, errstat, errmsg)
    print *, zout
    print *, errstat, errmsg
    

end program

.EE
.UNINDENT
.UNINDENT
.SS C
.INDENT 0.0
.INDENT 3.5
.sp
.EX
#include <stdio.h>
#include <stdlib.h>
#include \(dqecx.h\(dq


int main(void){

    int errstat, i;
    double w[3] = {1.0, 1.0, 1.0};
    double p[3] = {100.00, 0.0, 0.0};
    ecx_cdouble z[3] = {ecx_cbuild(0.0,0.0), 
                        ecx_cbuild(0.0, 0.0), 
                        ecx_cbuild(0.0, 0.0)};
    char *errmsg;

    ecx_eis_z(p, w, z, \(aqR\(aq, 3, 3, &errstat, &errmsg);
    
    for(i=0; i<3;i++){
        printf(\(dq%f %f \en\(dq, creal(z[i]), cimag(z[i]));
    }
    printf(\(dq%d %s\en\(dq, errstat, errmsg); 
    return EXIT_SUCCESS;
}

.EE
.UNINDENT
.UNINDENT
.SS Python
.INDENT 0.0
.INDENT 3.5
.sp
.EX
from pyecx import eis
import matplotlib.pyplot as plt

R = 100
C = 1e\-6
w = np.logspace(6, \-3, 100)

p = np.asarray([R, 0.0, 0.0])
zr = np.asarray(eis.z(\(dqR\(dq, w, p))
p = np.asarray([C, 0.0, 0.0])
zc = np.asarray(eis.z(\(dqC\(dq, w, p))
zrc = zr*zc / (zr+zc)
print(\(dqfinish\(dq)

fig = plt.figure()
ax = fig.add_subplot(111)

ax.set_aspect(\(dqequal\(dq)
ax.plot(zrc.real, zrc.imag, \(dqg.\(dq, label=\(dqR/C\(dq)

ax.invert_yaxis()

plt.show()
.EE
.UNINDENT
.UNINDENT
.SH APIS
.SS Fortran
.sp
\X'tty: link https://milanskocic.github.io/ecx/ford/index.html'\fI\%https://milanskocic.github.io/ecx/ford/index.html\fP\X'tty: link'
.SS ecx (module)
Main module for ecx.
.SS ecx__api (module)
API
\fBProcedures\fP
.PP
.SS get_version (function)
.INDENT 0.0
.TP
.B \fBfunction get_version() \-> fptr\fP
Get the version.
.INDENT 7.0
.TP
.B Returns
.INDENT 7.0
.TP
\fBfptr\fP (character(len=:), pointer)
Version of the library.
.UNINDENT
.UNINDENT
.UNINDENT
.SS kTe (function)
.INDENT 0.0
.TP
.B \fBpure elemental function kTe(T) \-> r\fP
Compute the thermal voltage.
.INDENT 7.0
.TP
.B Arguments
.INDENT 7.0
.TP
\fBT\fP (real(dp), intent(in))
Temperature in °C.
.UNINDENT
.UNINDENT
.INDENT 7.0
.TP
.B Returns
.INDENT 7.0
.TP
\fBr\fP (real(dp))
Thermal voltage in V.
.UNINDENT
.UNINDENT
.UNINDENT
.SS z (subroutine)
.INDENT 0.0
.TP
.B \fBsubroutine z(p, w, zout, e, errstat, errmsg)\fP
.INDENT 7.0
.TP
.B Arguments
.INDENT 7.0
.TP
\fBp\fP (real(dp), intent(in), dimension(:))
.TP
\fBw\fP (real(dp), intent(in), dimension(:))
Angular frequencies in rad.s\-1
.TP
\fBzout\fP (complex(dp), intent(out), dimension(:))
Complex impedance in Ohms.
.TP
\fBe\fP (character(len=1), intent(in))
Electrochemical element: R, C, L, Q, O, T, G
.TP
\fBerrstat\fP (integer(int32), intent(out))
Error status
.TP
\fBerrmsg\fP (character(len=:), intent(out), pointer)
Error message
.UNINDENT
.UNINDENT
.UNINDENT
.SS mm (subroutine)
.INDENT 0.0
.TP
.B \fBsubroutine mm(p, w, zout, n)\fP
.INDENT 7.0
.TP
.B Arguments
.INDENT 7.0
.TP
\fBp\fP (real(dp), intent(in), dimension(:))
Compute the measurement model.
.TP
\fBw\fP (real(dp), intent(in), dimension(:))
Parameters.
.TP
\fBzout\fP (complex(dp), intent(out), dimension(:))
Angular frequencies in rad.s\-1
.TP
\fBn\fP (integer(int32), intent(in))
Complex impedance in Ohms.
.UNINDENT
.UNINDENT
.UNINDENT
.SS nernst (function)
.INDENT 0.0
.TP
.B \fBpure function nernst(E0, z, aox, vox, ared, vred, T) \-> E\fP
Compute the Nernst electrochemical potential in V.
.INDENT 7.0
.TP
.B Arguments
.INDENT 7.0
.TP
\fBE0\fP (real(dp), intent(in))
.TP
\fBz\fP (integer(int32), intent(in))
Standard electrochemical potential in V.
.TP
\fBaox\fP (real(dp), intent(in), dimension(:))
Number of exchanged electrons.
.TP
\fBvox\fP (real(dp), intent(in), dimension(:))
Activities of the oxidants.
.TP
\fBared\fP (real(dp), intent(in), dimension(:))
Coefficients for the oxidants.
.TP
\fBvred\fP (real(dp), intent(in), dimension(:))
Activities of the reductants
.TP
\fBT\fP (real(dp), intent(in))
Coefficients for the reductants.
.UNINDENT
.UNINDENT
.INDENT 7.0
.TP
.B Returns
.INDENT 7.0
.TP
\fBE\fP (real(dp))
Temperature in °C.
.UNINDENT
.UNINDENT
.UNINDENT
.SS sbv (function)
.INDENT 0.0
.TP
.B \fBpure elemental function sbv(U, OCV, j0, aa, ac, za, zc, A, T) \-> I\fP
.INDENT 7.0
.TP
.B Arguments
.INDENT 7.0
.TP
\fBU\fP (real(dp), intent(in))
Open Circuit Voltage in V.
.TP
\fBOCV\fP (real(dp), intent(in))
Compute Butler Volmer equation without mass transport.
.TP
\fBj0\fP (real(dp), intent(in))
Electrochemical potential in V.
.TP
\fBaa\fP (real(dp), intent(in))
Exchange current density in A.cm\-2.
.TP
\fBac\fP (real(dp), intent(in))
Anodic transfer coefficient.
.TP
\fBza\fP (real(dp), intent(in))
Cathodic transfer coefficient.
.TP
\fBzc\fP (real(dp), intent(in))
Number of exchnaged electrons in the anodic branch.
.TP
\fBA\fP (real(dp), intent(in))
Number of exchnaged electrons in the cathodic branch.
.TP
\fBT\fP (real(dp), intent(in))
Area in cm2.
.UNINDENT
.UNINDENT
.INDENT 7.0
.TP
.B Returns
.INDENT 7.0
.TP
\fBI\fP (real(dp))
Temperature in °C.
.UNINDENT
.UNINDENT
.UNINDENT
.SS bv (function)
.INDENT 0.0
.TP
.B \fBpure elemental function bv(U, OCV, j0, jdla, jdlc, aa, ac, za, zc, A, T) \-> I\fP
Compute Butler Volmer equation with mass transport.
.INDENT 7.0
.TP
.B Arguments
.INDENT 7.0
.TP
\fBU\fP (real(dp), intent(in))
Open Circuit Voltage in V.
.TP
\fBOCV\fP (real(dp), intent(in))
.TP
\fBj0\fP (real(dp), intent(in))
Electrochemical potential in V.
.TP
\fBjdla\fP (real(dp), intent(in))
Exchange current density in A.cm\-2.
.TP
\fBjdlc\fP (real(dp), intent(in))
Anodic diffusion limiting current density in A.cm\-2.
.TP
\fBaa\fP (real(dp), intent(in))
Cathodic diffusion limiting current density in A.cm\-2.
.TP
\fBac\fP (real(dp), intent(in))
Anodic transfer coefficient.
.TP
\fBza\fP (real(dp), intent(in))
Cathodic transfer coefficient.
.TP
\fBzc\fP (real(dp), intent(in))
Number of exchnaged electrons in the anodic branch.
.TP
\fBA\fP (real(dp), intent(in))
Number of exchnaged electrons in the cathodic branch.
.TP
\fBT\fP (real(dp), intent(in))
Area in cm2.
.UNINDENT
.UNINDENT
.INDENT 7.0
.TP
.B Returns
.INDENT 7.0
.TP
\fBI\fP (real(dp))
Temperature in °C.
.UNINDENT
.UNINDENT
.UNINDENT
.SS ecx__capi (module)
\fBProcedures\fP
.PP
.SS capi_get_version (function)
.INDENT 0.0
.TP
.B \fBfunction capi_get_version()bind(c, name=\(dqecx_get_version\(dq) \-> cptr\fP
C API \- Get the version.
.INDENT 7.0
.TP
.B Returns
.INDENT 7.0
.TP
\fBcptr\fP (type(c_ptr))
.UNINDENT
.UNINDENT
.UNINDENT
.SS capi_nm2eV (subroutine)
.INDENT 0.0
.TP
.B \fBpure subroutine capi_nm2eV(lambda, E, n)bind(C, name=\(dqecx_core_nm2eV\(dq)\fP
.INDENT 7.0
.TP
.B Arguments
.INDENT 7.0
.TP
\fBlambda\fP (real(c_double), intent(in), dimension(n))
Wavelength in nm.
.TP
\fBE\fP (real(c_double), intent(out), dimension(n))
Energy in eV.
.TP
\fBn\fP (integer(c_size_t), intent(in), value)
Size of lambda and E.
.UNINDENT
.UNINDENT
.UNINDENT
.SS capi_kTe (subroutine)
.INDENT 0.0
.TP
.B \fBpure subroutine capi_kTe(T, kTe_, n)bind(C, name=\(dqecx_core_kTe\(dq)\fP
.INDENT 7.0
.TP
.B Arguments
.INDENT 7.0
.TP
\fBT\fP (real(c_double), intent(in), dimension(n))
Temperature in °C.
.TP
\fBkTe_\fP (real(c_double), intent(out), dimension(n))
Thermal voltage in V.
.TP
\fBn\fP (integer(c_size_t), intent(in), value)
Size of T and kTe.
.UNINDENT
.UNINDENT
.UNINDENT
.SS capi_z (subroutine)
.INDENT 0.0
.TP
.B \fBsubroutine capi_z(p, w, zout, e, k, n, errstat, errmsg)bind(C, name=\(dqecx_eis_z\(dq)\fP
.INDENT 7.0
.TP
.B Arguments
.INDENT 7.0
.TP
\fBp\fP (real(c_double), intent(in), dimension(k))
Parameters.
.TP
\fBw\fP (real(c_double), intent(in), dimension(n))
Angular frequencies in rad.s\-1
.TP
\fBzout\fP (complex(c_double_complex), intent(out), dimension(n))
Complex impedance in Ohms.
.TP
\fBe\fP (character(len=1,kind=c_char), intent(in), value)
Electrochemical element: R, C, L, Q, O, T, G
.TP
\fBk\fP (integer(c_size_t), intent(in), value)
Size of p
.TP
\fBn\fP (integer(c_size_t), intent(in), value)
Size of w
.TP
\fBerrstat\fP (integer(c_int), intent(out))
Error status
.TP
\fBerrmsg\fP (type(c_ptr), intent(out))
errmsg Error message
.UNINDENT
.UNINDENT
.UNINDENT
.SS capi_nernst (function)
.INDENT 0.0
.TP
.B \fBpure function capi_nernst(E0, z, aox, vox, nox, ared, vred, nred, T)bind(C, name=\(dqecx_kinetics_nernst\(dq) \-> E\fP
Compute the Nernst electrochemical potential in V.
.INDENT 7.0
.TP
.B Arguments
.INDENT 7.0
.TP
\fBE0\fP (real(c_double), intent(in), value)
.TP
\fBz\fP (integer(c_int), intent(in), value)
Standard electrochemical potential in V.
.TP
\fBaox\fP (real(c_double), intent(in), dimension(nox))
Number of reductants.
.TP
\fBvox\fP (real(c_double), intent(in), dimension(nox))
Activities of the oxidants.
.TP
\fBnox\fP (integer(c_size_t), intent(in), value)
Number of exchanged electrons.
.TP
\fBared\fP (real(c_double), intent(in), dimension(nred))
Coefficients for the oxidants.
.TP
\fBvred\fP (real(c_double), intent(in), dimension(nred))
Activities of the reductants
.TP
\fBnred\fP (integer(c_size_t), intent(in), value)
Number of oxidants.
.TP
\fBT\fP (real(c_double), intent(in), value)
Coefficients for the reductants.
.UNINDENT
.UNINDENT
.INDENT 7.0
.TP
.B Returns
.INDENT 7.0
.TP
\fBE\fP (real(c_double))
Temperature in °C.
.UNINDENT
.UNINDENT
.UNINDENT
.SS capi_sbv (subroutine)
.INDENT 0.0
.TP
.B \fBpure subroutine capi_sbv(U, OCV, j0, aa, ac, za, zc, A, T, I, n)bind(c, name=\(dqecx_kinetics_sbv\(dq)\fP
Compute Butler Volmer equation without mass transport.
.INDENT 7.0
.TP
.B Arguments
.INDENT 7.0
.TP
\fBU\fP (real(c_double), intent(in), dimension(n))
Open circuit potential in volts.
.TP
\fBOCV\fP (real(c_double), intent(in), value)
Size of U and I.
.TP
\fBj0\fP (real(c_double), intent(in), value)
Potential in volts.
.TP
\fBaa\fP (real(c_double), intent(in), value)
Exchange current density in A.cm\-2.
.TP
\fBac\fP (real(c_double), intent(in), value)
Anodic transfert coefficient.
.TP
\fBza\fP (real(c_double), intent(in), value)
Cathodic transfert coefficient.
.TP
\fBzc\fP (real(c_double), intent(in), value)
Number of exchanged electrons in anodic branch.
.TP
\fBA\fP (real(c_double), intent(in), value)
Number of exchanged electrons in cathodic branch.
.TP
\fBT\fP (real(c_double), intent(in), value)
Area in cm2.
.TP
\fBI\fP (real(c_double), intent(out), dimension(n))
Temperature in °C.
.TP
\fBn\fP (integer(c_size_t), intent(in), value)
.UNINDENT
.UNINDENT
.UNINDENT
.SS capi_bv (subroutine)
.INDENT 0.0
.TP
.B \fBpure subroutine capi_bv(U, OCV, j0, jdla, jdlc, aa, ac, za, zc, A, T, I, n)bind(c, name=\(dqecx_kinetics_bv\(dq)\fP
Compute Butler Volmer equation without mass transport.
.INDENT 7.0
.TP
.B Arguments
.INDENT 7.0
.TP
\fBU\fP (real(c_double), intent(in), dimension(n))
Open circuit potential in volts.
.TP
\fBOCV\fP (real(c_double), intent(in), value)
Size of U and I.
.TP
\fBj0\fP (real(c_double), intent(in), value)
Potential in volts.
.TP
\fBjdla\fP (real(c_double), intent(in), value)
Exchange current density in A.cm\-2
.TP
\fBjdlc\fP (real(c_double), intent(in), value)
Anodic diffusion limiting current density in A.cm\-2.
.TP
\fBaa\fP (real(c_double), intent(in), value)
Cathodic diffusion limiting current density in A.cm\-2.
.TP
\fBac\fP (real(c_double), intent(in), value)
Anodic transfert coefficient.
.TP
\fBza\fP (real(c_double), intent(in), value)
Cathodic transfert coefficient.
.TP
\fBzc\fP (real(c_double), intent(in), value)
Number of exchanged electrons in anodic branch.
.TP
\fBA\fP (real(c_double), intent(in), value)
Number of exchanged electrons in cathodic branch.
.TP
\fBT\fP (real(c_double), intent(in), value)
Area in cm2.
.TP
\fBI\fP (real(c_double), intent(out), dimension(n))
Temperature in °C.
.TP
\fBn\fP (integer(c_size_t), intent(in), value)
.UNINDENT
.UNINDENT
.UNINDENT
.SS C
.INDENT 0.0
.INDENT 3.5
.sp
.EX
#ifndef ECX_H
#define ECX_H
#include <complex.h>
#if _MSC_VER
    #define ADD_IMPORT __declspec(dllimport)
    typedef _Dcomplex ecx_cdouble; 
    #define ecx_cbuild(real, imag) (_Cbuild(real, imag))
#else
    #define ADD_IMPORT
    typedef double _Complex ecx_cdouble; 
    #define ecx_cbuild(real, imag) (real+I*imag) 
#endif

extern char* ecx_get_version(void);


ADD_IMPORT extern const double ecx_core_PI; 
ADD_IMPORT extern const double ecx_core_T_K; 
void ecx_core_nm2eV(double *lambda, double *E, size_t n); 
void ecx_core_kTe(double *U, double *kTE, size_t n); 


extern double ecx_kinetics_nernst(double E0, int z, 
                                       double *aox, double *vox, size_t nox, 
                                       double *ared, double *vred, size_t nred, 
                                       double T);

extern void ecx_kinetics_sbv(double *U, double OCV, double j0, 
                                  double aa, double ac, double za, double zc,
                                  double A, double T, double *i, size_t n);

extern void ecx_kinetics_bv(double *U, double OCV, double j0, double jdla, double jdlc,
                        double aa, double ac, double za, double zc,
                        double A, double T, double *i, size_t n);


extern void ecx_eis_z(double *p, double *w, ecx_cdouble *z, 
                      char e, size_t k, size_t n, 
                      int *errstat, char *(*errmsg)); 

#endif



.EE
.UNINDENT
.UNINDENT
.SS Python
.sp
Python wrapper of the (Modern Fortran) ecx library.
.SH PROGRAMS
.SS ecxcli (program)
.INDENT 0.0
.INDENT 3.5
.sp
.EX
program ecxcli
    !! CLI interface for electrochemistry.
    use ieee_arithmetic, only: ieee_is_nan
    use iso_fortran_env, only: real64, int32, output_unit
    use ecx
    use ciaaw, only: ciaaw_version => get_version, get_saw, print_periodic_table,&
                     get_z_by_symbol
    use M_CLI2
    implicit none

    integer :: i
    integer(int32) :: zmass
    real(real64) :: r, dr
    character(len=32) :: cmd
    character(len=:),allocatable, target  :: help_text(:), version_text(:), usage_text(:)
    character(len=:), pointer :: char_fp(:)
    character(len=3) :: elmt
    
    nullify(char_fp)

    help_text=[character(len=80) :: &
        \(aqNAME                                                            \(aq, &
        \(aq  ecxcli(1) \- Command line for ecx                              \(aq, &
        \(aq                                                                \(aq, &
        \(aqSYNOPSIS                                                        \(aq, &
        \(aq  ecxcli SUBCOMMAND [OPTIONS ...] ARGS ...                      \(aq, &
        \(aq                                                                \(aq, &
        \(aqDESCRIPTION                                                     \(aq, &
        \(aq  ecxcli is command line interface for computing electro\-       \(aq, &
        \(aq  chemical properties:                                          \(aq, &
        \(aq    o EIS         Electrochemical Impedance Z=f(w)              \(aq, &
        \(aq    o Kinetics    j=f(U)                                        \(aq, &
        \(aq    o PEC         Iph=f(hv, U)                                  \(aq, &
        \(aq                                                                \(aq, &
        \(aq  It can also provide the molar masses, isotope compositions and\(aq, &
        \(aq  nuclide compositions.\(aq, &
        \(aq                                                                \(aq, &
        \(aqSUBCOMMANDS                                                     \(aq, &
        \(aq  o all  Get the whole periodic table.                          \(aq, &
        \(aq  o saw  Get the standard atomic weight.                        \(aq, &
        !\(aq  o ice  Get the isotopic composition of the element.           \(aq, &
        !\(aq  o naw  Get the nuclide atomic weight.                         \(aq, &
        \(aq                                                                \(aq, &
        \(aq  Enter ecxcli SUBCOMMAND \-\-help for detailed descriptions.     \(aq, &
        \(aq                                                                \(aq, &
        \(aqOPTIONS                                                         \(aq, &
        \(aq  o \-\-abridged, \-a     Use the abridged value.                  \(aq, &
        \(aq  o \-\-uncertainty, \-u  Use the uncertainty.                     \(aq, &
        \(aq  o \-\-pprint           Nice formatting.                         \(aq, &
        \(aq  o \-\-mass, \-z         Get the mass number.                     \(aq, &
        \(aq                                                                \(aq, &
        \(aqVALID FOR ALL SUBCOMMANDS                                       \(aq, &
        \(aq  o \-\-help     Show help text and exit                          \(aq, & 
        \(aq  o \-\-verbose  Display additional information when available.   \(aq, &
        \(aq  o \-\-version  Show version information and exit.               \(aq, &
        \(aq                                                                \(aq, &
        \(aq\(aq ]

    version_text=[character(len=80) :: &
        \(aqPROGRAM:      ecxcli                \(aq, &
        \(aqDESCRIPTION:  Command line for ecx  \(aq, &
        \(aqVERSION:      \(aq//get_version()//\(aq   \(aq, &
        \(aqAUTHOR:       M. Skocic             \(aq, &
        \(aqLICENSE:      MIT                   \(aq, &
        \(aq\(aq ]

    usage_text=[character(len=80) :: &
        \(aqUsage: ecxcli SUBCOMMAND [OPTIONS...]|[\-\-help|\-\-version] ELEMENTS...\(aq, &
        \(aq\(aq ]

    cmd = get_subcommand()
    call set_mode(\(aqstrict\(aq)

    select case (cmd)
        case (\(dqsaw\(dq)
            call set_args(\(dq\-\-abridged:a \-\-uncertainty:u \-\-mass:z \-\-pprint\(dq, get_help_saw(), version_text)
            if(size(unnamed) == 1) then
                write(output_unit, \(dq(A)\(dq) \(dqEnter at least one element.\(dq
                char_fp => usage_text
                call print_text(char_fp)
                stop
            end if
            do i=2, size(unnamed)
                elmt = unnamed(i)
                zmass = get_z_by_symbol(elmt)
                if(lget(\(dqpprint\(dq))then
                    r = get_saw(elmt,abridged=lget(\(dqa\(dq))
                    dr = get_saw(elmt, abridged=lget(\(dqa\(dq), uncertainty=.true.)
                    if(lget(\(dqmass\(dq))then
                        write(output_unit, \(aq(A4, A3, A3, SP, G14.6, A3, ES14.2, S, A5, I3, A1)\(aq) &
                              \(aqSAW_\(aq, elmt, \(dq = \(dq, r, \(dq+/\-\(dq, dr, \(aq (Z=\(aq, zmass, \(aq)\(aq
                    else
                        write(output_unit, \(aq(A4, A3, A3, SP, G14.6, A3, ES14.2)\(aq) &
                              \(aqSAW_\(aq, elmt, \(dq = \(dq, r, \(dq+/\-\(dq, dr
                    end if
                else
                    r = get_saw(elmt,abridged=lget(\(dqa\(dq), uncertainty=lget(\(dqu\(dq))
                    if(lget(\(dqmass\(dq))then
                        write(output_unit, \(aq(I4, 4X, G0.16)\(aq) zmass, r
                    else
                        write(output_unit, \(aq(G0.16)\(aq) r
                    end if
                end if
            end do
        case (\(dqall\(dq)
            call set_args(\(dq \(dq, help_text, version_text)
            call  print_periodic_table()
        case default
            call set_args(\(dq \(dq, help_text, version_text)
            char_fp => usage_text
            call print_text(char_fp)
    end select

contains

function get_help_saw()result(res)
    !! Get the help text for the subcommand saw.
    character(len=80), allocatable :: res(:)
    res = [character(len=80) :: &
        \(aqNAME                                                            \(aq, &
        \(aq  saw \- th ecxcli subcommand to get the standard atomic weight. \(aq, &
        \(aq                                                                \(aq, &
        \(aqSYNOPSIS                                                        \(aq, &
        \(aq  ecxcli saw [OPTIONS ...] ELEMENTS ...                      \(aq, &
        \(aq                                                                \(aq, &
        \(aqDESCRIPTION                                                     \(aq, &
        \(aq  Provide the saw either abridged or not.                       \(aq, &
        \(aq  The uncertainty of the saw can be retrieved too.              \(aq, &
        \(aq                                                                \(aq, &
        \(aqOPTIONS                                                         \(aq, &
        \(aq  o \-\-abridged, \-a     Use the abridged value.                  \(aq, &
        \(aq  o \-\-uncertainty, \-u  Use the uncertainty.                     \(aq, &
        \(aq  o \-\-pprint           Nice formatting.                         \(aq, &
        \(aq  o \-\-mass, \-z         Get the mass number.                     \(aq, &
        \(aq                                                                \(aq, &
        \(aqVALID FOR ALL SUBCOMMANDS                                       \(aq, &
        \(aq  o \-\-help     Show help text and exit                          \(aq, & 
        \(aq  o \-\-verbose  Display additional information when available.   \(aq, &
        \(aq  o \-\-version  Show version information and exit.               \(aq, &
        \(aq                                                                \(aq, &
        \(aqEXAMPLE                                                         \(aq, &
        \(aq  Minimal example                                               \(aq, &
        \(aq      ecxcli saw H                                              \(aq, &
        \(aq      ecxcli saw \-a \-u O                                        \(aq, &
        \(aq      ecxcli saw H C B O Zr Nb \-\-pprint                         \(aq, &
        \(aq      ecxcli saw \-a H C B O Zr Nb \-\-pprint                      \(aq, &
        \(aq                                                                \(aq, &
        \(aq\(aq ]
end function

subroutine print_text(char_fp)
    character(len=:), pointer, intent(in) :: char_fp(:)
    integer :: i
    do i=1, size(char_fp), 1
        write (OUTPUT_UNIT, \(aq(A)\(aq) char_fp(i)
    end do
end subroutine


end program

.EE
.UNINDENT
.UNINDENT
\fBDependencies\fP
.PP
.INDENT 0.0
.IP \(bu 2
\fBM_CLI2\fP
.IP \(bu 2
\fBciaaw\fP
.IP \(bu 2
\fI\%ecx\fP
.IP \(bu 2
\fBieee_arithmetic\fP
.IP \(bu 2
\fBiso_fortran_env\fP
.UNINDENT
\fBProcedures\fP
.PP
.SS get_help_saw (function)
.INDENT 0.0
.TP
.B \fBfunction get_help_saw() \-> res\fP
Get the help text for the subcommand saw.
.INDENT 7.0
.TP
.B Returns
.INDENT 7.0
.TP
\fBres\fP (character(len=80), allocatable, dimension(:))
.UNINDENT
.UNINDENT
.UNINDENT
.SS print_text (subroutine)
.INDENT 0.0
.TP
.B \fBsubroutine print_text(char_fp)\fP
.INDENT 7.0
.TP
.B Arguments
.INDENT 7.0
.TP
\fBchar_fp\fP (character(len=:), pointer, intent(in), dimension(:))
.UNINDENT
.UNINDENT
.UNINDENT
.SH CHANGELOG
.SS Version 0.1.0\-dev
.INDENT 0.0
.IP \(bu 2
Implementation of eis + C API
.IP \(bu 2
Python wrappers for eis.
.UNINDENT
.SH AUTHOR
Milan Skocic
.SH COPYRIGHT
Copyright, Milan Skocic
.\" Generated by docutils manpage writer.
.
